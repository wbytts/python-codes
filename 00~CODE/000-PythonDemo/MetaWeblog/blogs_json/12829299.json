{'dateCreated': <DateTime '20200505T04:42:00' at 0x1a4f251de88>, 'description': '转：https://www.cnblogs.com/ldq2016/p/6245987.html\n\n在项目中切换Fragment，一直都是用replace()方法来替换Fragment。但是这样做有一个问题，每次切换的时候Fragment都会重新实列化，重新加载一次数据，这样做会非常消耗性能用用户的流量。\n\n官方文档解释说：replace()这个方法只是在上一个Fragment不再需要时采用的简便方法。\n\n正确的切换方式是add()，切换时hide()，add()另一个Fragment；再次切换时，只需hide()当前，show()另一个。\n这样就能做到多个Fragment切换不重新实例化：\n```java\n/**\n     * fragment 切换\n     * \n     * @param from\n     * @param to\n     */\n    public void switchContent(Fragment from, Fragment to, int position) {\n        if (mContent != to) {\n            mContent = to;\n            FragmentTransaction transaction = fm.beginTransaction();\n            if (!to.isAdded()) { // 先判断是否被add过\n                transaction.hide(from)\n                        .add(R.id.content_frame, to, tags[position]).commit(); // 隐藏当前的fragment，add下一个到Activity中\n            } else {\n                transaction.hide(from).show(to).commit(); // 隐藏当前的fragment，显示下一个\n            }\n        }\n    }\n```\n\n这样做好后看似没问题。但是比较低端的手机内存不足的时候会造成fragment重叠的情况。\n\n实是由Activity被回收后重启所导致的Fragment重复创建和重叠的问题。\n\n在Activity onCreate()中添加Fragment的时候一定不要忘了检查一下savedInstanceState：\n\n多个Fragment重叠则可以这样处理：通过FragmentManager找到所有的UI Fragment，按需要show()某一个Fragment，hide()其他即可！\n\n为了能准确找出所需的Fragment，所以在add()或者replace() Fragment的时候记得要带上tag参数，因为一个ViewGroup 容器可以依附add()多个Fragment，它们的id自然是相同的。\n\n```java\n/**\n     * 状态检测 用于内存不足的时候保证fragment不会重叠\n     * \n     * @param savedInstanceState\n     */\n    private void stateCheck(Bundle savedInstanceState) {\n        if (savedInstanceState == null) {\n            fm = getFragmentManager();\n            FragmentTransaction fts = fm.beginTransaction();\n            AnimationFragment af = new AnimationFragment();\n            mContent = af;\n            fts.add(R.id.content_frame, af);\n            fts.commit();\n        } else {\n            AnimationFragment af = (AnimationFragment) getFragmentManager()\n                    .findFragmentByTag(tags[0]);\n            PlainFragment pf = (PlainFragment) getFragmentManager()\n                    .findFragmentByTag(tags[1]);\n            RecordFragment rf = (RecordFragment) getFragmentManager()\n                    .findFragmentByTag(tags[2]);\n            InformationFragment inf = (InformationFragment) getFragmentManager()\n                    .findFragmentByTag(tags[3]);\n            TestingFragment tf = (TestingFragment) getFragmentManager()\n                    .findFragmentByTag(tags[4]);\n            getFragmentManager().beginTransaction().show(af).hide(pf).hide(rf)\n                    .hide(inf).hide(tf).commit();\n        }\n    }\n```\n', 'title': 'Android 中 Fragment 的切换（解决 replace 的低效）', 'categories': ['[随笔分类]Android~'], 'enclosure': {'length': 0}, 'link': 'https://www.cnblogs.com/wbyixx/p/12829299.html', 'permalink': 'https://www.cnblogs.com/wbyixx/p/12829299.html', 'postid': '12829299', 'source': {}, 'userid': '-2'}